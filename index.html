<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>番茄時鐘</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;`
      margin: 0;
      padding: 0;
      background-color: #121212;
      color: white;
    }
    .container {
      width: 500px;
      height: 500px;
      margin: 50px auto;
      position: relative;
    }
    .background-image {
      position: absolute;
      width: calc(100% - 40px);  /* 減去進度條的寬度 */
      height: calc(100% - 40px);
      top: 20px;  /* 進度條寬度的一半 */
      left: 20px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      z-index: 1;
    }
    .timer {
      font-size: 4em;
      font-weight: bold;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);  /* 添加文字陰影提高可讀性 */
    }
    .progress-ring {
      transform: rotate(-90deg);
      position: absolute;
      top: 0;
      left: 0;
      z-index: 3;
    }
    .progress-ring__circle {
      fill: transparent;
      stroke-width: 20;
      stroke-linecap: round;
    }
    .controls {
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s;
      margin: 0 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
    #upload {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="container">
      <div class="background-image" :style="{ backgroundImage: `url(${backgroundImage})` }"></div>
      <svg class="progress-ring" :width="size" :height="size">
        <defs>
          <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#FFD700" />
            <stop offset="50%" stop-color="#FFA500" />
            <stop offset="100%" stop-color="#FF4500" />
          </linearGradient>
        </defs>
        <!-- 背景圓圈 -->
        <circle
          class="progress-ring__circle"
          :stroke="'#333'"
          :r="radius"
          :cx="center"
          :cy="center"
        />
        <!-- 進度圓圈 -->
        <circle
          class="progress-ring__circle"
          stroke="url(#gradient)"
          :r="radius"
          :cx="center"
          :cy="center"
          :stroke-dasharray="circumference"
          :stroke-dashoffset="dashOffset"
        />
      </svg>
      <div class="timer">{{ minutes }}:{{ seconds }}</div>
    </div>
    <div class="controls">
      <button @click="startTimer">開始</button>
      <button @click="resetTimer">重設</button>
      <input id="upload" type="file" accept="image/*" @change="uploadImage">
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      try {
        new Vue({
          el: '#app',
          data: {
            totalTime: 25 * 60,
            remainingTime: 25 * 60,
            timer: null,
            size: 500,
            strokeWidth: 20,
            backgroundImage: ''
          },
          computed: {
            minutes() {
              return String(Math.floor(this.remainingTime / 60)).padStart(2, '0');
            },
            seconds() {
              return String(this.remainingTime % 60).padStart(2, '0');
            },
            radius() {
              return (this.size / 2) - this.strokeWidth;
            },
            center() {
              return this.size / 2;
            },
            circumference() {
              return 2 * Math.PI * this.radius;
            },
            progress() {
              return ((this.totalTime - this.remainingTime) / this.totalTime);
            },
            dashOffset() {
              return this.circumference * (1 - this.progress);
            }
          },
          methods: {
            startTimer() {
              if (this.timer) return;
              this.timer = setInterval(() => {
                if (this.remainingTime > 0) {
                  this.remainingTime--;
                } else {
                  clearInterval(this.timer);
                  this.timer = null;
                }
              }, 1000);
            },
            resetTimer() {
              clearInterval(this.timer);
              this.timer = null;
              this.remainingTime = this.totalTime;
            },
            uploadImage(event) {
              const file = event.target.files[0];
              if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                  this.backgroundImage = e.target.result;
                };
                reader.readAsDataURL(file);
              }
            }
          }
        });
      } catch (error) {
        console.error('Vue initialization error:', error);
      }
    });
  </script>
</body>
</html>